# This Rigelfile file was automatically generated by Robotair.
# Feel free to alter it according to your needs.

# For more information on Rigel and Rigelfiles visit:
# https://github.com/rigel-ros/rigel
---

vars:
    distro: "jazzy"

application:
    distro: "{{ vars.distro }}"

providers:

    container_registry_provider_1:
        provider: "rigel.providers.core.ContainerRegistryProvider"
        with:
            server: "https://index.docker.io/v1/"
            username: "robotair"
            password: "{{ secrets.REGISTRY_SECRET }}"

jobs:

    dockerfile:
        plugin: "rigel.plugins.core.DockerfilePlugin"
        with:
            ros_image: "docker.io/library/ros:jazzy-ros-base"
            command: "ros2 run hello_robotair hello_node"
            compiler:
                name: "colcon"
            username: "robotair"

    build:
        plugin: "rigel.plugins.core.BuildXPlugin"
        with:
            image: "robotair/hello_robotair"
            tags:
                - "latest"
                - "jazzy-v0.0.1"
            load: False
            push: True
            platforms:
                - "linux/amd64"
                - "linux/arm64"


sequences:

    robotair:
        stages:
            -
                jobs:
                    - "dockerfile"
                    - "build"